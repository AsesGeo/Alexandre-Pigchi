<!DOCTYPE html>
<html>
   <head>
          <title>Alexandre</title>

         <!--Enlace a leaflet-->
         <link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css" integrity="sha512-xodZBNTC5n17Xt2atTPuE1HxjVMSvLVW9ocqUKLsCC5CXdbqCmblAshOMAS6/keqq/sMZMZ19scR4PsZChSR7A==" crossorigin="" />
         <script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js" integrity="sha512-XQoYMqMTK8LvdxXYG3nZ448hOEQiglfqkJs1NOQV44cWnUrBc8PkAOcXy20w0vlaXaVUearIOBhiXZ5V3ynxwA==" crossorigin=""></script> 
    
          <!--Enlace al plugin Legend Master-->
          <link rel="stylesheet" href="https://ptma.github.io/Leaflet.Legend/src/leaflet.legend.css">
          <script src="https://ptma.github.io/Leaflet.Legend/src/leaflet.legend.js"></script>
          


          <!-- Plugin Leaflet.markercluster-->
            <link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster@1.4.1/dist/MarkerCluster.css">
            <link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster@1.4.1/dist/MarkerCluster.Default.css">
            <script src="https://unpkg.com/leaflet.markercluster@1.4.1/dist/leaflet.markercluster-src.js"></script>


            <link rel="stylesheet" href="https://norkart.github.io/Leaflet-MiniMap/Control.MiniMap.css">
            <script src="https://norkart.github.io/Leaflet-MiniMap/Control.MiniMap.js"></script>

        <!--Definción de estilos CSS-->
          <style>
          html, body {height:100%} 
          #mapDiv {
              height: 600px;
              width: 1000px; 
             }
             
             .legend {
                padding: 6px 40px;
                background-color: rgba(255,255,255,0.8);
                box-shadow: 0 0 15px rgba(0,0,0,0.2);
                border-radius: 5px;
            }

            .title {
            width: 120px;
            height: 110px;
            font-size: 12px;
            color: #f5f5f5;
            font-family: "Arial";
            padding: 10px 14px;
            background-color: rgba(10, 143, 204, 0.829);
            box-shadow: 0 0 15px rgba(0,0,0,0.2);
            border-radius: 3px;
            border: 1px solid rgb(11, 8, 187);
            }

          </style>


    </head>
          <body>
          <div id="mapDiv"></div>
         
          <script src="https://ajax.googleapis.com/ajax/libs/jquery/1/jquery.min.js"></script>

          
          <script>
            //Construcción del mapa JS y definciión de mapas base
            var map = new L.Map('mapDiv',
                
              { center:[29.00867, -106.28791],
                zoom:17
              });
            var osmAttrib = 'Map data © <a href="http://openstreetmap.org">OpenStreetMap</a> contributors';
            var subdomains = ['a', 'b' ,'c'];
         
            //Ajustes del mapa base
            var tile_settings = {
                minZoom: 1,
                maxZoom: 25,
                attribution: osmAttrib,
                subdomains: subdomains
            };
           
            //Opciones de mapas base
            var osmUrl = "http://{s}.tile.openstreetmap.fr/hot/{z}/{x}/{y}.png";
            var mapNik = "https://{s}.tiles.wmflabs.org/osm-no-labels/{z}/{x}/{y}.png";
            var esrisat= "https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}";
            
            tiles = {
                "OSM": new L.TileLayer(osmUrl, tile_settings),
                "Mapnik": new L.TileLayer(mapNik, tile_settings),
                "satelite": new L.TileLayer(esrisat, tile_settings),
            };
            
            map.addLayer(tiles["satelite"]);

           
            
        
        //CARGAR GEOJSON
        $.when($.getJSON("alexandre_comanche.geojson"), $.getJSON("limite_estatal.geojson"),$.getJSON("limite_muni.geojson"), $.getJSON("limte_nac.geojson"), $.getJSON("Comanche.geojson") ). done( function(data1, data2, data3, data4, data5) {
   

          
            var geojson1= new L.GeoJSON(data1,{pointToLayer: function(feature, latlng) {
                    var arbol= 'tree.png'
                                        var mapicon= L.icon({
                                            iconUrl: arbol,
                                            iconSize:[15,15],

                                        });
                                    return L.marker(latlng, {icon:mapicon});
                        
                        
          }, onEachFeature: function(feature,layer){
                         var popup1= 
                          '<div class="popup">' + '<b>Info</b><br><hr>'+
                          '<strong>ID: </strong>'+ feature.properties.consecutiv + '<br>' + 
                          '<strong>Planted: </strong>'+ feature.properties.dia + '<br>'+ 
                          '<strong>Scientific name: </strong><I>'+ feature.properties.nombre_cie + '</I><br>'+
                          '<strong>Common name: </strong>'+ feature.properties.nombre_com + '<br>'+ 
                          '<strong>Client: </strong>'+ feature.properties.due_o + '<br>'+ 
                          '</div>'
                          layer.bindPopup(popup1);
          }});
          
          var clusterejemplo = L.markerClusterGroup({spiderfyOnMaxZoom: true, bubblingMouseEvents: true});
        
          clusterejemplo.addLayer(geojson1);
          

          

          var geojson2 = new L.GeoJSON(data2, {style: style2});
          var geojson3 = new L.GeoJSON(data3, {style: style3});
          var geojson4 = new L.GeoJSON(data4, {style: style4});
          var geojson5 = new L.GeoJSON(data5, {style: style5});
          

            //MOSTRAR CAPAS
            map.addLayer(geojson4);
            map.addLayer(geojson3);
            map.addLayer(geojson2);
            map.addLayer(geojson5);
            map.addLayer(geojson1);
            map.addLayer(clusterejemplo);
            
            
           
 
            //ACTIVAR/DESACTIVAR CAPAS
            var overlays = {
                "Assigned trees": geojson1,
                "Comanche":geojson5,
                "Chihuahua municipality": geojson3,
                "Chihuahua state": geojson2,
                "Mexico": geojson4,

            }
            L.control.layers(tiles, overlays).addTo(map); 
            
            //CONTROL DE ESCALA
            L.control.scale({imperial:false, maxWidth:100}).addTo(map); 
        });
        
      
      //ÍNDICE
         
          function style2 (feature){
               return{
                fillColor: "transparent",
                fillOpacity:0.75,
                color: "#8000FF",
                weight: 3,
                dashArray: "10, 10" 
               }
                }
                function style3 (feature){
               return{
                fillColor: "transparent",
                fillOpacity:0.75,
                color: "#0040FF",
                weight: 2, 
                dashArray: "10, 10" 
               }
                }
                function style4 (feature){
               return{
                fillColor: "transparent",
                fillOpacity:0.75,
                color: "#A4A4A4",
                weight: 3,
                dashArray: "10, 10" 
               }
                }
                function style5 (feature){
               return{
                fillColor: "transparent",
                fillOpacity:0.75,
                color: "#FF0000",
                weight: 3,
                dashArray: "10, 10" 
               }
                }
          //RECUADRO DE INFORMACION
           
              let title = L.control({position: "bottomleft"});

              title.onAdd = function() {
                  let div = L.DomUtil.create("div", "title");
                  div.innerHTML = 
                  '<p><b><h2>2°much!</h2></b></p><hr>' +
                  'Action Climatique' +
                  '<br>Nous sommes votre allié</br>'
                  '</br>';
                    return div;
                  };
              title.addTo(map);

          //LEYENDA DEL MAPA
                              var legend = L.control.legend({
                              position: "bottomright",
                              collapsed: false,
                              symbolWidth:18,
                              symbolHeight:10,
                              opacity: 0.75,
                              column: 1,
                              title: 'Legend',
                              legends: [
                              {
                                label: "Assigned trees",
                                type: "image",
                                url:"tree.png"
                              },{
                                label: 'Comanche',
                                        type: "rectangle",
                                        fillColor:"transparent",
                                        color: "#FF0000",
                                        dashArray:[5,5],
                                        weight: 2,
                              },{
                                label: 'Municipality of Chihuahua',
                                        type: "rectangle",
                                        color: "#0040FF",
                                        fillColor:"transparent",
                                        dashArray:[5,5],
                                        weight: 2,
                                       
                              },{
                                label: 'Chihuahua state',
                                        type: "rectangle",
                                        fillColor:"transparent",
                                        color: "#8000FF",
                                        dashArray:[5,5],
                                        weight: 2,
                              },{
                                label: 'Mexico',
                                        type: "rectangle",
                                        fillColor:"transparent",
                                        color: "#A4A4A4",
                                        dashArray:[5,5],
                                        weight: 2,
                              },
                              ]
                            }).addTo(map);
        </script>
     </body>
</html>